import{r as a,j as e}from"./index-COcsu5PX.js";import{M as h,A as y,a as S,C}from"./ConfirmDeleteModal-HmO_tzqU.js";import{S as D,N as A}from"./Navbar-BMXlO6mQ.js";import{u as k}from"./Camera Logo-BH3ukDBV.js";import{g as c,p as I,d as R}from"./api-Cyf7xHkP.js";const O=()=>{const[f,m]=a.useState(!1),[v,x]=a.useState(null),[p,l]=a.useState([]),[g,r]=a.useState([]),[u,j]=a.useState("default"),{token:i}=k(),[n,d]=a.useState(null);a.useEffect(()=>{i&&(async()=>{try{const s=await c("/savedmovies",i);l(s);const o=await Promise.all(s.map(N=>c(`/movies/${N}`)));r(o.filter(Boolean))}catch(s){console.error("Failed to load saved movies",s)}})()},[i]);const w=async t=>{if(!p.includes(t))try{await I(`/savedmovies/${t}`,{},i),l(o=>[...o,t]);const s=await c(`/movies/${t}`,i);s&&r(o=>[...o,s])}catch(s){console.error("Failed to add movie",s)}},b=async t=>{try{await R(`/savedmovies/${t}`,i),l(s=>s.filter(o=>o!==t)),r(s=>s.filter(o=>o.id!==t))}catch(s){console.error("Failed to remove movie",s)}},M=[...g].sort((t,s)=>{switch(u){case"rating":return s.voteAverage-t.voteAverage;case"recent":return new Date(s.releaseDate||0).getTime()-new Date(t.releaseDate||0).getTime();case"az":return t.title.localeCompare(s.title);default:return 0}});return e.jsxs("div",{className:"flex h-screen overflow-hidden",children:[e.jsx("aside",{className:"w-[250px] bg-white shadow-md h-full",children:e.jsx(D,{})}),e.jsxs("div",{className:"flex flex-col flex-grow h-full",children:[e.jsx(A,{title:"Overview"}),e.jsxs("main",{className:"flex-grow overflow-y-auto bg-gradient-to-b bg-slate-100 p-10",children:[e.jsx("div",{className:"flex justify-end mb-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"mr-2 text-sm font-medium text-slate-700",children:"Sort by:"}),e.jsxs("select",{className:"border rounded px-3 py-1 text-sm",value:u,onChange:t=>j(t.target.value),children:[e.jsx("option",{value:"default",children:"Default"}),e.jsx("option",{value:"rating",children:"Highest Rating"}),e.jsx("option",{value:"recent",children:"Most Recent"}),e.jsx("option",{value:"az",children:"A-Z"})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-4 gap-6",children:[M.map(t=>e.jsxs("div",{title:t.title,className:"relative group transition-transform hover:scale-105 max-w-[300px] cursor-pointer animate-fade-in",children:[e.jsx("button",{onClick:s=>{s.stopPropagation(),d({id:t.id,title:t.title})},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full px-2.5 py-1 text-sm font-bold opacity-0 group-hover:opacity-100 transition-opacity z-10 cursor-pointer",title:"Remove movie",children:"X"}),e.jsx("div",{onClick:()=>x(t.id),children:e.jsx(h,{movieId:t.id,asCard:!0})})]},t.id)),e.jsx("div",{className:"max-w-[300px]",children:e.jsx(y,{onClick:()=>m(!0)})})]})]})]}),f&&e.jsx(S,{onClose:()=>m(!1),onAddToDashboard:w,onAddToWatchlist:()=>{}}),v!==null&&e.jsx("div",{className:"fixed inset-0 backdrop-blur-sm bg-slate-700/25 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-2xl max-w-4xl w-full flex gap-6 relative",children:[e.jsx("button",{className:"absolute top-4 right-4 text-xl font-bold text-indigo-700 hover:text-indigo-900",onClick:()=>x(null),children:"Ã—"}),e.jsx(h,{movieId:v})]})}),n&&e.jsx(C,{movieTitle:n.title,onCancel:()=>d(null),onConfirm:()=>{b(n.id),d(null)}})]})};export{O as default};
