import{r as a,j as e}from"./index-DyPFOE30.js";import{M as u,A as S,a as C,C as D}from"./ConfirmDeleteModal-Duq6cUFl.js";import{S as A,N as k}from"./Navbar-DHXLt7-U.js";import{u as I}from"./Camera Logo-D_JI16dJ.js";import{g as h,p as f,d as R}from"./api-bsFxf6iW.js";const O=()=>{const[p,c]=a.useState(!1),[m,v]=a.useState(null),[g,l]=a.useState([]),[j,r]=a.useState([]),[x,w]=a.useState("default"),{token:i}=I(),[n,d]=a.useState(null);a.useEffect(()=>{i&&(async()=>{try{const s=await h("/savedmovies",i);l(s);const o=await Promise.all(s.map(y=>h(`/movies/${y}`)));r(o.filter(Boolean))}catch(s){console.error("Failed to load saved movies",s)}})()},[i]);const b=async t=>{if(!g.includes(t))try{await f(`/savedmovies/${t}`,{},i),l(o=>[...o,t]);const s=await f(`/movies/${t}`,{},i);s&&r(o=>[...o,s])}catch(s){console.error("Failed to add movie",s)}},M=async t=>{try{await R(`/savedmovies/${t}`,i),l(s=>s.filter(o=>o!==t)),r(s=>s.filter(o=>o.id!==t))}catch(s){console.error("Failed to remove movie",s)}},N=[...j].sort((t,s)=>{switch(x){case"rating":return s.voteAverage-t.voteAverage;case"recent":return new Date(s.releaseDate||0).getTime()-new Date(t.releaseDate||0).getTime();case"az":return t.title.localeCompare(s.title);default:return 0}});return e.jsxs("div",{className:"flex h-screen overflow-hidden",children:[e.jsx("aside",{className:"w-[250px] bg-white shadow-md h-full",children:e.jsx(A,{})}),e.jsxs("div",{className:"flex flex-col flex-grow h-full",children:[e.jsx(k,{title:"Overview"}),e.jsxs("main",{className:"flex-grow overflow-y-auto bg-gradient-to-b bg-slate-100 p-10",children:[e.jsx("div",{className:"flex justify-end mb-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"mr-2 text-sm font-medium text-slate-700",children:"Sort by:"}),e.jsxs("select",{className:"border rounded px-3 py-1 text-sm",value:x,onChange:t=>w(t.target.value),children:[e.jsx("option",{value:"default",children:"Default"}),e.jsx("option",{value:"rating",children:"Highest Rating"}),e.jsx("option",{value:"recent",children:"Most Recent"}),e.jsx("option",{value:"az",children:"A-Z"})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-4 gap-6",children:[N.map(t=>e.jsxs("div",{title:t.title,className:"relative group transition-transform hover:scale-105 max-w-[300px] cursor-pointer animate-fade-in",children:[e.jsx("button",{onClick:s=>{s.stopPropagation(),d({id:t.id,title:t.title})},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full px-2.5 py-1 text-sm font-bold opacity-0 group-hover:opacity-100 transition-opacity z-10 cursor-pointer",title:"Remove movie",children:"X"}),e.jsx("div",{onClick:()=>v(t.id),children:e.jsx(u,{movieId:t.id,asCard:!0})})]},t.id)),e.jsx("div",{className:"max-w-[300px]",children:e.jsx(S,{onClick:()=>c(!0)})})]})]})]}),p&&e.jsx(C,{onClose:()=>c(!1),onAddToDashboard:b,onAddToWatchlist:()=>{}}),m!==null&&e.jsx("div",{className:"fixed inset-0 backdrop-blur-sm bg-slate-700/25 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-2xl max-w-4xl w-full flex gap-6 relative",children:[e.jsx("button",{className:"absolute top-4 right-4 text-xl font-bold text-indigo-700 hover:text-indigo-900",onClick:()=>v(null),children:"Ã—"}),e.jsx(u,{movieId:m})]})}),n&&e.jsx(D,{movieTitle:n.title,onCancel:()=>d(null),onConfirm:()=>{M(n.id),d(null)}})]})};export{O as default};
