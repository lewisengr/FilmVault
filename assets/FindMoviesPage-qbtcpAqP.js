import{r as o,a as N,j as t}from"./index-Bxq-Y2IP.js";import{S,N as k}from"./Navbar-Ck7Ygzbv.js";import{A as d,p as A}from"./api-BPstxoyE.js";import"./Camera Logo-CYCuahmZ.js";const $=s=>({id:s.id,title:s.title,overview:s.overview,posterPath:s.poster_path,voteAverage:s.vote_average,releaseDate:s.release_date,fullPosterPath:s.poster_path?`https://image.tmdb.org/t/p/w500${s.poster_path}`:""}),P=s=>s.replace(/[^\w\s]/gi,"").trim(),_=()=>{const[s,v]=o.useState(""),[b,w]=o.useState([]),[n,f]=o.useState({}),[l,c]=o.useState(null),{token:i}=N(),[j,y]=o.useState(!1),h=o.useCallback(async()=>{const e=P(s),a=e?`${d}/movies/search?query=${encodeURIComponent(e)}&include_adult=true&language=en-US`:`${d}/movies/popular`,u=(await(await fetch(a)).json()).map($);w(u)},[s]);o.useEffect(()=>{const e=setTimeout(()=>{h()},200);return()=>clearTimeout(e)},[s,h]),o.useEffect(()=>{(async()=>{if(i)try{const[a,r]=await Promise.all([fetch(`${d}/savedmovies`,{headers:{Authorization:`Bearer ${i}`}}),fetch(`${d}/watchlist`,{headers:{Authorization:`Bearer ${i}`}})]),[g,u]=await Promise.all([a.ok?a.json():[],r.ok?r.json():[]]),m={};for(const x of g)m[x]="Vault";for(const x of u)m[x]="Watchlist";f(m)}catch(a){console.error("Error fetching saved/watched movies:",a)}})()},[i]);const p=async(e,a)=>{try{await A(`/${a}/${e.id}`,{},i),f(r=>({...r,[e.id]:a==="savedmovies"?"Vault":"Watchlist"}))}catch(r){console.error("Error adding movie:",r),alert("An error occurred while saving the movie.")}c(null)};return t.jsxs("div",{className:"flex h-screen overflow-hidden",children:[t.jsx("aside",{className:`
    bg-white shadow-md h-full w-[250px] z-40
    sm:relative sm:translate-x-0 sm:transition-none
    fixed top-0 left-0 transform transition-transform duration-300 ease-in-out
    ${j?"translate-x-0":"-translate-x-full sm:translate-x-0"}
  `,children:t.jsx(S,{})}),t.jsx("button",{onClick:()=>y(e=>!e),className:"sm:hidden fixed top-[90px] left-4 z-50 bg-white shadow p-2 rounded",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"w-6 h-6",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5m-16.5 5.25h16.5m-16.5 5.25h16.5"})})}),t.jsxs("div",{className:"flex flex-col flex-grow h-full",children:[t.jsx(k,{title:"Find Movies"}),t.jsxs("main",{className:"flex-grow overflow-y-auto bg-gradient-to-b bg-slate-100 p-10",children:[t.jsx("form",{onSubmit:e=>{e.preventDefault(),h()},className:"mb-6 max-w-xl",children:t.jsx("input",{type:"text",value:s,onChange:e=>v(e.target.value),placeholder:"Search for a movie...",className:"border px-4 py-2 rounded w-full"})}),t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-4 gap-6",children:b.map(e=>t.jsxs("div",{className:"bg-white rounded shadow p-2 flex flex-col items-center transition-transform duration-300 hover:scale-[1.02] animate-fade-in",children:[e.fullPosterPath?t.jsx("img",{src:e.fullPosterPath,alt:e.title,loading:"lazy",title:e.title,className:"w-full aspect-[2/3] object-cover rounded"}):t.jsx("div",{className:"w-full aspect-[2/3] bg-gray-200 rounded flex items-center justify-center text-gray-500 text-xs",children:"No Image"}),t.jsx("h3",{className:"mt-2 text-sm font-medium text-center",children:e.title}),t.jsx("button",{onClick:()=>c(e),className:`mt-2 px-3 py-1 rounded text-sm font-semibold transition cursor-pointer ${n[e.id]?"bg-gray-400 text-white cursor-not-allowed":"bg-indigo-600 text-white hover:bg-indigo-700"}`,disabled:!!n[e.id],children:n[e.id]?`Added to ${n[e.id]}`:"Add"})]},e.id))}),l&&t.jsx("div",{className:"fixed inset-0 bg-opacity-20 backdrop-blur-md flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-[350px]",children:[t.jsxs("h3",{className:"text-lg font-semibold mb-4 text-slate-800 text-center",children:["Add ",t.jsx("strong",{children:l.title})," to:"]}),t.jsxs("div",{className:"flex justify-around mt-4",children:[t.jsx("button",{className:"bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded cursor-pointer",onClick:()=>p(l,"savedmovies"),title:"Add to Vault",children:"Vault"}),t.jsx("button",{className:"bg-violet-600 hover:bg-violet-700 text-white px-6 py-2 rounded cursor-pointer",onClick:()=>p(l,"watchlist"),title:"Add to Watchlist",children:"Watchlist"})]}),t.jsx("button",{onClick:()=>c(null),className:"block mt-6 mx-auto text-sm text-gray-500 hover:underline cursor-pointer",title:"Cancel",children:"Cancel"})]})})]})]})]})};export{_ as default};
