import{r as a,j as e}from"./index-Dd0bwh6b.js";import{S as b,N as M}from"./Navbar-pxCHBz6X.js";import{M as u,A as N,a as y,C}from"./ConfirmDeleteModal-DvkvqOz7.js";import{g as n,p as S,d as D}from"./api-bsFxf6iW.js";import"./Camera Logo-Ck0wfH2F.js";const z=()=>{const[c,i]=a.useState([]),[d,p]=a.useState("default"),[v,h]=a.useState(!1),[x,m]=a.useState(null),[o,r]=a.useState(null);a.useEffect(()=>{(async()=>{try{const s=await n("/watchlist"),l=await Promise.all(s.map(w=>n(`/movies/${w}`)));i(l)}catch(s){console.error("Failed to load watchlist",s)}})()},[]);const f=async t=>{if(!c.find(s=>s.id===t))try{await S(`/watchlist/${t}`,{});const s=await n(`/movies/${t}`);i(l=>[...l,s])}catch(s){console.error("Error adding to watchlist:",s)}},g=async t=>{try{await D(`/watchlist/${t}`),i(s=>s.filter(l=>l.id!==t))}catch(s){console.error("Failed to remove from watchlist",s)}},j=[...c].sort((t,s)=>{switch(d){case"rating":return s.voteAverage-t.voteAverage;case"recent":return new Date(s.releaseDate??"").getTime()-new Date(t.releaseDate??"").getTime();case"az":return t.title.localeCompare(s.title);default:return 0}});return e.jsxs("div",{className:"flex h-screen overflow-hidden",children:[e.jsx("aside",{className:"w-[250px] bg-white shadow-md h-full",children:e.jsx(b,{})}),e.jsxs("div",{className:"flex flex-col flex-grow h-full",children:[e.jsx(M,{title:"Watchlist"}),e.jsxs("main",{className:"flex-grow overflow-y-auto bg-gradient-to-b bg-slate-100 p-10",children:[e.jsx("div",{className:"flex justify-end mb-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"mr-2 text-sm font-medium text-slate-700",children:"Sort by:"}),e.jsxs("select",{className:"border rounded px-3 py-1 text-sm",value:d,onChange:t=>p(t.target.value),children:[e.jsx("option",{value:"default",children:"Default"}),e.jsx("option",{value:"rating",children:"Highest Rating"}),e.jsx("option",{value:"recent",children:"Most Recent"}),e.jsx("option",{value:"az",children:"A-Z"})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-4 gap-6",children:[j.map(t=>e.jsxs("div",{title:t.title,className:"relative group transition-transform hover:scale-105 max-w-[300px] cursor-pointer animate-fade-in",children:[e.jsx("button",{onClick:s=>{s.stopPropagation(),r({id:t.id,title:t.title})},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full px-2.5 py-1 text-sm font-bold opacity-0 group-hover:opacity-100 transition-opacity z-10",title:"Remove movie",children:"×"}),e.jsx("div",{onClick:()=>m(t.id),children:e.jsx(u,{movieId:t.id,asCard:!0})})]},t.id)),e.jsx("div",{className:"max-w-[300px]",children:e.jsx(N,{onClick:()=>h(!0)})})]})]})]}),v&&e.jsx(y,{isWatchlist:!0,onClose:()=>h(!1),onAddToDashboard:()=>{},onAddToWatchlist:f}),x!==null&&e.jsx("div",{className:"fixed inset-0 backdrop-blur-sm bg-slate-700/25 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-2xl max-w-4xl w-full flex gap-6 relative",children:[e.jsx("button",{className:"absolute top-4 right-4 text-xl font-bold text-indigo-700 hover:text-indigo-900",onClick:()=>m(null),children:"×"}),e.jsx(u,{movieId:x})]})}),o&&e.jsx(C,{movieTitle:o.title,onCancel:()=>r(null),onConfirm:()=>{g(o.id),r(null)}})]})};export{z as default};
