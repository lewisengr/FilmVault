import{r as l,j as e}from"./index-COcsu5PX.js";import{S as M,N}from"./Navbar-BMXlO6mQ.js";import{M as f,A as y,a as C,C as S}from"./ConfirmDeleteModal-HmO_tzqU.js";import{g as c,p as D,d as A}from"./api-Cyf7xHkP.js";import{u as W}from"./Camera Logo-BH3ukDBV.js";const P=()=>{const[d,i]=l.useState([]),[h,p]=l.useState("default"),[v,x]=l.useState(!1),[m,u]=l.useState(null),[r,n]=l.useState(null),{token:a}=W();l.useEffect(()=>{(async()=>{try{const s=await c("/watchlist",a),o=await Promise.all(s.map(b=>c(`/movies/${b}`,a)));i(o)}catch(s){console.error("Failed to load watchlist",s)}})()},[a]);const g=async t=>{if(!d.find(s=>s.id===t))try{await D(`/watchlist/${t}`,{},a);const s=await c(`/movies/${t}`,a);i(o=>[...o,s])}catch(s){console.error("Error adding to watchlist:",s)}},j=async t=>{try{await A(`/watchlist/${t}`,a),i(s=>s.filter(o=>o.id!==t))}catch(s){console.error("Failed to remove from watchlist",s)}},w=[...d].sort((t,s)=>{switch(h){case"rating":return s.voteAverage-t.voteAverage;case"recent":return new Date(s.releaseDate??"").getTime()-new Date(t.releaseDate??"").getTime();case"az":return t.title.localeCompare(s.title);default:return 0}});return e.jsxs("div",{className:"flex h-screen overflow-hidden",children:[e.jsx("aside",{className:"w-[250px] bg-white shadow-md h-full",children:e.jsx(M,{})}),e.jsxs("div",{className:"flex flex-col flex-grow h-full",children:[e.jsx(N,{title:"Watchlist"}),e.jsxs("main",{className:"flex-grow overflow-y-auto bg-gradient-to-b bg-slate-100 p-10",children:[e.jsx("div",{className:"flex justify-end mb-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"mr-2 text-sm font-medium text-slate-700",children:"Sort by:"}),e.jsxs("select",{className:"border rounded px-3 py-1 text-sm",value:h,onChange:t=>p(t.target.value),children:[e.jsx("option",{value:"default",children:"Default"}),e.jsx("option",{value:"rating",children:"Highest Rating"}),e.jsx("option",{value:"recent",children:"Most Recent"}),e.jsx("option",{value:"az",children:"A-Z"})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-4 gap-6",children:[w.map(t=>e.jsxs("div",{title:t.title,className:"relative group transition-transform hover:scale-105 max-w-[300px] cursor-pointer animate-fade-in",children:[e.jsx("button",{onClick:s=>{s.stopPropagation(),n({id:t.id,title:t.title})},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full px-2.5 py-1 text-sm font-bold opacity-0 group-hover:opacity-100 transition-opacity z-10",title:"Remove movie",children:"×"}),e.jsx("div",{onClick:()=>u(t.id),children:e.jsx(f,{movieId:t.id,asCard:!0})})]},t.id)),e.jsx("div",{className:"max-w-[300px]",children:e.jsx(y,{onClick:()=>x(!0)})})]})]})]}),v&&e.jsx(C,{isWatchlist:!0,onClose:()=>x(!1),onAddToDashboard:()=>{},onAddToWatchlist:g}),m!==null&&e.jsx("div",{className:"fixed inset-0 backdrop-blur-sm bg-slate-700/25 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-2xl max-w-4xl w-full flex gap-6 relative",children:[e.jsx("button",{className:"absolute top-4 right-4 text-xl font-bold text-indigo-700 hover:text-indigo-900",onClick:()=>u(null),children:"×"}),e.jsx(f,{movieId:m})]})}),r&&e.jsx(S,{movieTitle:r.title,onCancel:()=>n(null),onConfirm:()=>{j(r.id),n(null)}})]})};export{P as default};
